<style>
    .sticky-menu {
        position: sticky;
    }

    .mce-toolbar, .mce-container {
        background-color: #f8f8f8;
    }

    .sticky-wrapper.is-sticky .mce-container:first-child {
        background-color: #f8f8f8;
        margin-left: -46px;
        padding-left: 49px;
    }
</style>
<script src="{{ asset('js/tinymce/tinymce.min.js') }}"></script>
<script src="{{ asset('js/tinymce/jquery.tinymce.min.js') }}"></script>

<script>
    $(document).on('ready', function () {
        // textarea unique selector
        var selector = '#{{ id }}';
        // tinyMce content css path
        var tinyMceContentCss = '{{ asset(contentCss) }}';

        var translations = {
            addGallery: "{{ 'cms.gallery.add_gallery' | trans | raw }}",
            addImage: "{{ 'cms.gallery.add_image' | trans | raw }}"
        };
        var plugins = {{ plugins | default('[]') | json_encode | raw }};
        var toolbar = '{{ toolbar }}';

        tinymce.init({
            selector: selector,
            plugins: plugins,
            toolbar1: toolbar,
            image_advtab: true,
            imagetools_toolbar: "rotateleft rotateright | flipv fliph | editimage imageoptions",
            content_css: tinyMceContentCss,
            body_class: 'mceForceColors container',
            content_style: 'body.container {background-color:#eeeae8; padding:20px 60px;}',
            // enable default browser spell check
            browser_spellcheck: true,
            setup: function (editor) {
                editor.addButton('add_gallery', {
                    text: translations.addGallery,
                    icon: false,
                    onclick: function () {
                        var galleryModal = $('#gallery-modal');

                        galleryModal.on('show.bs.modal', function () {
                            galleryModal.find('#media-container').load('{{ path('cms.media.gallery.modal') }}');
                        });
                        galleryModal.modal('show');
                    }
                });
                editor.addButton('add_image', {
                    text: translations.addImage,
                    icon: 'image',
                    'class': 'test',
                    onclick: function () {
                        var url = '{{ path('cms.media.add_image_modal') }}';

                        console.log('trace');

                        Modal.open(url);

//                        var imageModal = $('#add-image-modal');
//
//                        imageModal.find('#image-form-container').load();
//                        imageModal.modal('show');
                    }
                });
                editor.on('PostRender', function () {
                    var top = 51;

                    // add sticky tinymce toolbar to avoid issues with long articles
                    $('.mce-toolbar')
                        .each(function () {
                            $(this).sticky({
                                topSpacing: top,
                                zIndex: 900,
                                bottomSpacing: 400
                            });
                            top += 35;
                            $(this).show();
                        })
                        .css('height', '35px')
                        .parent('.sticky-wrapper')
                        .css('height', '35px')
                    ;
                });
            }
        });
    });
</script>

{% include '@JKCms/Media/modal.html.twig' %}
{#{% include '@JKCms/Article/addImage.modal.html.twig' %}#}
