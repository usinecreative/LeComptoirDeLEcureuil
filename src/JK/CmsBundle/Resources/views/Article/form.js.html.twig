<style>
    .sticky-menu {
        position: sticky;
    }

    .mce-toolbar, .mce-container {
        background-color: #f8f8f8;
    }

    .sticky-wrapper.is-sticky .mce-container:first-child {
        background-color: #f8f8f8;
        margin-left: -46px;
        padding-left: 49px;
    }
</style>
<script src="{{ asset('js/tinymce/tinymce.min.js') }}"></script>
<script src="{{ asset('js/tinymce/jquery.tinymce.min.js') }}"></script>

<script>
    $(document).on('ready', function () {
        // textarea unique selector
        var selector = '#{{ id }}';
        // tinyMce content css path
        var tinyMceContentCss = '{{ asset(contentCss) }}';

        var translations = {
            addGallery: "{{ 'cms.gallery.add_gallery' | trans | raw }}"
        };
        var plugins = {{ plugins | default('[]') | json_encode | raw }};
        var toolbar = '{{ toolbar }}';

        tinymce.init({
            selector: selector,
            plugins: plugins,
            toolbar1: toolbar,
            image_advtab: true,
            imagetools_toolbar: "rotateleft rotateright | flipv fliph | editimage imageoptions",
            content_css: tinyMceContentCss,
            body_class: 'mceForceColors container',
            content_style: 'body.container {background-color:#eeeae8; padding:20px 60px;}',
            setup: function (editor) {
                editor.addButton('add_gallery', {
                    text: translations.addGallery,
                    icon: false,
                    onclick: function () {
                        var galleryModal = $('#gallery-modal');

                        galleryModal.on('show.bs.modal', function () {
                            galleryModal.find('#media-container').load('{{ path('cms.media.gallery.modal') }}');
                        });
                        galleryModal.modal('show');
                    }
                });
                editor.on('PostRender', function (e) {
                    var top = 51;

                    $('.mce-toolbar')
                        .each(function () {
                            $(this).sticky({
                                topSpacing: top,
                                zIndex: 5000,
                                bottomSpacing: 400
                            });
                            top += 35;
                            $(this).show();
                        })
                        .css('height', '35px')
                        .parent('.sticky-wrapper')
                        .css('height', '35px')
                    ;
                });
            }
        });
    });
</script>

{% include '@JKCms/Media/modal.html.twig' %}
